---
title: "Untitled"
author: "Jason Grahn"
date: "1/20/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

#Homework 3 
##6.27 
Baten, Tack, and Baeder (1958) compared judges' scores on fish prepared by three methods. Twelve fish were cooked by each method, and several judges tasted fish samples and rated each on four variables: $y_{1}$  — aroma, $y_{2}$ = flavor, $y_{3}$ = texture, and $y_{4}$ — moisture. The data are in Table 6.17. Each entry is an average score for the judges on that fish. 

```{r build matrix for 6.27}
fish <- 
    readr::read_table2(file = here::here("/assignment03/T6_17_FISH.DAT"),
                   col_names = FALSE) %>% 
  select(X1:X5) %>% 
  mutate(X1 = factor(X1))

head(fish,10)
#names(fish)
```

###(a) 
Compare the three methods using all four MANOVA tests.
```{r}
manova.data <- manova(cbind(X2 ,X3, X4, X5) ~ X1,
                     data=fish)
manova.data
```

## Wilks' test
```{r}
lambda <- summary(manova.data, test = "Wilks")
lambda
```

## Pillai test
```{r}
pillai <- summary(manova.data, test = "Pillai")
pillai
```

## Roy test
```{r}
roy <- summary(manova.data, test = "Roy")
roy
```

## Hotelling-Lawley test:
```{r}
hotelling <- summary(manova.data, test = "Hotelling-Lawley")
hotelling
```

```{r}
summary.aov(manova.data)
```

##6.28 
Table 6.18 from Keuls et al. (1984) gives data from a two-way (fixed-effects) MANOVA on snap beans showing the results of four variables: $y_{1}$ = yield earliness, $y_{2}$ = specific leaf area (SLA) earliness, $y_{3}$ = total yield, and $y_{4}$ = average SLA. The factors are sowing date (S) and variety (V).

```{r build matrix for 6.28}
snapbeans <- 
  readr::read_table2(file = here::here("/assignment03/T6_18_SNAPBEAN.DAT"),
                   col_names = FALSE) %>% 
  select(X1:X7) %>% 
  rename(S = X1,
         V = X2,
         pl = X3,
         y1 = X4,
         y2 = X5,
         y3 = X6,
         y4 = X7) %>% 
  mutate(S = factor(S),
         V = factor(V),
         pl = factor(pl))

head(snapbeans, 5)
```


```{r}
manova.beans <- manova(cbind(y1 ,y2, y3, y4) ~ S * V,
                       data=snapbeans)

manova.beans
```


###(a)
Test for main effects and interaction using all four MANOVA statistics.

##Wilks’ Test
(this is a kind of test to measure if means are equal)
```{r}
lambda.beans <- summary(manova.beans, test = "Wilks")
lambda.beans
```

## Pillai test
```{r}
pillai <- summary(manova.beans, test = "Pillai")
pillai
```

## Roy test
```{r}
roy <- summary(manova.beans, test = "Roy")
roy
```

## Hotelling-Lawley test:
```{r}
hotelling <- summary(manova.beans, test = "Hotelling-Lawley")
hotelling
```
